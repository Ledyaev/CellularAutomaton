@model CellularAutomaton.Web.Models.AutomatonViewModel
@{
    ViewBag.Title = "Клеточный автомат";
    var tags = Model.Tags.Split(new char[] { ',', ' ' }, StringSplitOptions.RemoveEmptyEntries);
    for (int i = 0; i < tags.Count(); i++)
    {
        tags[i] = tags[i].ToLower();
    }  
}
<h2>@ViewBag.Title.</h2>
<h3>@Model.Name  Автор: @Model.CreatorName</h3>
<div class="container-fluid">
    <div class="col-md-offset-3">
        <div id="lifejs ">
            <input id="hdAutomatonId" type="hidden" value="@Model.Id" />
            <div id="toolbar">
                <span id="info"></span><br />
                <a href="#" id="tbStep" class="btn btn-sm btn-default">Один шаг</a>
                <a href="#" id="tbStart" class="btn btn-sm btn-default"> Запуск</a>
                <a href="#" id="tbStop" class="btn btn-sm btn-default"> Стоп</a>
                <a href="#" id="tbZoomOut" class="btn btn-sm btn-default">Уменьшить</a>
                <a href="#" id="tbZoomIn" class="btn btn-sm btn-default">Увеличить</a>
                <a href="#" id="tbCenter" class="btn btn-sm btn-default">По центру</a>
                <a href="#" id="tbReset" class="btn btn-sm btn-default">Сброс</a>

            </div>
            <div class="row">
                <div style="background-color: white; height: 500px; width: 500px">
                    <div id="frame"><canvas id="field"></canvas><div id="evcap" title="Ctrl+drag для перемещения поля"></div></div>
                </div>
                <ul class="list-group col-md-6">
                    <li class="bg-info list-group-item">
                        Правила
                    </li>
                    <li class="list-group-item">
                        <label class="control-label" for="birth">Рождение</label>
                        <input class="form-control" id="birth" name="birth" type="text" value="@Model.Birth" />
                    </li>
                    <li class="list-group-item">
                        <label class=" control-label" for="loneliness">Одиночество</label>
                        <input class="form-control" id="loneliness" name="loneliness" type="text" value="@Model.Loneliness" />
                    </li>
                    <li class="list-group-item">
                        <label class=" control-label" for="overcrowding">Переполнение</label>
                        <input class="form-control" id="overcrowding" name="overcrowding" type="text" value="@Model.Loneliness" />
                    </li>
                    <li class="list-group-item">
                        <a href="#" id="tbApply" class="btn btn-sm btn-default">Применить правила</a>
                    </li>
                    @if (User.Identity.IsAuthenticated)
                    {
                        <li class="list-group-item">
                            <button class="btn btn-sm btn-primary " id="tbSaveModal" data-toggle="modal" data-target="#saveModal">Сохранить как</button>
                            @if (Model.CreatorName == User.Identity.Name)
                            {
                                <button class="btn btn-sm btn-primary " id="tbSaveAsModal" data-toggle="modal" data-target="#resaveModal">Сохранить</button>
                            }
                        </li>
                    }
                </ul>

                <div class="modal fade" id="saveModal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true" style="display: none;">
                    <div class="modal-dialog modal-sm">
                        <div class="modal-content">
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                                <h4 class="modal-title" id="mySmallModalLabel">Сохранение</h4>
                            </div>
                            <div>
                                <div class="modal-body">
                                    <div class="form-group">
                                        <label class=" control-label" for="saveAsName">Название</label>
                                        <input class="form-control" id="saveAsName" name="saveAsName" type="text" />
                                    </div>
                                    <div class="form-group">
                                        <label class="control-label" for="saveAsDiscription">Описание</label>
                                        <textarea id="saveAsDiscription" name="saveAsDiscription" cols="30" rows="4"></textarea>
                                    </div>
                                    <div class="form-group">
                                        <label class=" control-label" for="saveAsTags">Теги</label>
                                        <input class="form-control" id="saveAsTags" name="saveAsTags" type="text" />
                                    </div>
                                    <div class="form-group">
                                        <button class="btn btn-sm btn-primary col-md-offset-4" id="tbSaveAs">Сохранить</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal fade" id="resaveModal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true" style="display: none;">
                    <div class="modal-dialog modal-sm">
                        <div class="modal-content">
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                                <h4 class="modal-title" id="mySmallModalLabel">Сохранение</h4>
                            </div>
                            <div>
                                <div class="modal-body">
                                    <div class="form-group">
                                        <label class=" control-label" for="saveName">Название</label>
                                        <input class="form-control" id="saveName" name="saveName" type="text" value="@Model.Name" />
                                    </div>
                                    <div class="form-group">
                                        <label class="control-label" for="saveDiscription">Описание</label>
                                        <textarea id="saveDiscription" name="saveDiscription" cols="30" rows="4">@Model.Discription</textarea>
                                    </div>
                                    <div class="form-group">
                                        <button class="btn btn-sm btn-primary col-md-offset-4" id="tbSave">Сохранить</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>




        </div>
    </div>

</div>

@section scripts{
    <script src="~/Scripts/l.js"></script>
    <script>
        var birth = Number("@Model.Birth");
        var owercrowding = Number("@Model.Overcrowding");
        var loneliness = Number("@Model.Loneliness");
        var area = "@Model.Area";
        $(function () { LifeGame.init(area,birth,owercrowding,loneliness); });
    </script>
}
